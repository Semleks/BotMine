<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BotMine</title>
    <!-- Google Font: Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        /* –û–±—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞ */
        :root {
            --bg-color: #1a1b26;
            --surface-color: #24283b;
            --text-color: #c0caf5;
            --border-color: #414868;
            --accent-green: #9ece6a;
            --accent-red: #f7768e;
            --accent-blue: #7aa2f7;
            --accent-gray: #5c6370;
            --accent-orange: #e09f3e; /* –î–æ–±–∞–≤–ª–µ–Ω */
            --accent-purple: #a78bfa; /* –î–æ–±–∞–≤–ª–µ–Ω */
            --accent-cyan: #8be9fd; /* –ù–æ–≤—ã–π —Ü–≤–µ—Ç –¥–ª—è "–ß—Ç–æ –Ω–æ–≤–æ–≥–æ" */
            --modal-bg: rgba(16, 16, 21, 0.8);
            --shadow-light: rgba(0, 0, 0, 0.2);
            --shadow-medium: rgba(0, 0, 0, 0.35);
            --shadow-heavy: rgba(0, 0, 0, 0.5);

            /* –¶–≤–µ—Ç–∞ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ */
            --doc-keyword: #a78bfa; /* accent-purple */
            --doc-variable: #9ece6a; /* accent-green */
            --doc-string: #f7768e;   /* accent-red */
            --doc-comment: #5c6370;  /* accent-gray */
            --doc-json-key: #7aa2f7; /* accent-blue */
        }

        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ */
        body {
            background-color: var(--bg-color);
            background-image: linear-gradient(135deg, var(--bg-color) 0%, #171821 100%); /* –ì—Ä–∞–¥–∏–µ–Ω—Ç */
            color: var(--text-color);
            font-family: 'Poppins', sans-serif; /* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Poppins */
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            align-items: flex-start; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Å–≤–µ—Ä—Ö—É */
        }

        .container {
            width: 100%;
            max-width: 800px;
            background-color: var(--surface-color);
            border-radius: 12px;
            box-shadow: 0 10px 30px var(--shadow-heavy); /* –ì–ª—É–±–æ–∫–∞—è —Ç–µ–Ω—å –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
            padding: 30px;
            margin-top: 20px;
            animation: fadeIn 0.5s ease-out; /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –ó–∞–≥–æ–ª–æ–≤–∫–∏ */
        h1 {
            border-bottom: 2px solid var(--accent-blue);
            padding-bottom: 15px;
            color: white;
            font-weight: 600;
            font-size: 2.5em;
            text-align: center;
            margin-bottom: 30px;
            letter-spacing: 1px;
        }

        h2, h3, h4 {
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            color: white;
            font-weight: 500;
            margin-top: 30px;
            margin-bottom: 20px;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        button {
            display: inline-flex; /* –î–ª—è –∏–∫–æ–Ω–æ–∫ */
            align-items: center;
            justify-content: center;
            color: #fff;
            border: none;
            border-radius: 8px; /* –ß—É—Ç—å –±–æ–ª–µ–µ —Å–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ —É–≥–ª—ã */
            padding: 12px 20px; /* –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π –ø–∞–¥–¥–∏–Ω–≥ */
            margin: 8px; /* –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π –æ—Ç—Å—Ç—É–ø */
            cursor: pointer;
            font-size: 15px;
            font-weight: 600; /* –ë–æ–ª–µ–µ –∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç */
            transition: all 0.2s ease; /* –ü–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –¥–ª—è –≤—Å–µ—Ö —Å–≤–æ–π—Å—Ç–≤ */
            box-shadow: 0 4px 10px var(--shadow-light); /* –õ–µ–≥–∫–∞—è —Ç–µ–Ω—å */
        }

        button i {
            margin-right: 8px; /* –û—Ç—Å—Ç—É–ø –¥–ª—è –∏–∫–æ–Ω–∫–∏ */
        }

        button:hover:not(:disabled) {
            opacity: 1; /* –£–±—Ä–∞–Ω opacity, –≤–º–µ—Å—Ç–æ –Ω–µ–≥–æ transform –∏ shadow */
            transform: translateY(-3px); /* –õ–µ–≥–∫–∏–π –ø–æ–¥—ä–µ–º */
            box-shadow: 0 6px 15px var(--shadow-medium); /* –£—Å–∏–ª–µ–Ω–Ω–∞—è —Ç–µ–Ω—å */
        }
        button:active:not(:disabled) {
            transform: translateY(0);
            box-shadow: 0 2px 5px var(--shadow-light);
        }

        button:disabled {
            cursor: not-allowed;
            opacity: 0.6; /* –ù–µ–º–Ω–æ–≥–æ —Ç–µ–º–Ω–µ–µ –¥–ª—è disabled */
            box-shadow: none;
        }

        #startBot { background-color: var(--accent-green); }
        #stopBot { background-color: var(--accent-red); }
        #openModalBtn { background-color: var(--accent-blue); }
        #sendMessage { background-color: var(--accent-gray); }
        #exportBotDataBtn { background-color: var(--accent-orange); }
        #importBotDataBtn { background-color: var(--accent-purple); }
        #whatsNewBtn { background-color: var(--accent-cyan); } /* –°—Ç–∏–ª—å –¥–ª—è –Ω–æ–≤–æ–π –∫–Ω–æ–ø–∫–∏ */
        #createBotBtn, #saveSettingsBtn { background-color: var(--accent-green); width: calc(100% - 16px); }


        /* –ò–Ω–ø—É—Ç—ã */
        input[type="text"], input[type="password"] {
            background-color: var(--bg-color); /* –¢–µ–º–Ω–µ–µ —Ñ–æ–Ω –¥–ª—è –∏–Ω–ø—É—Ç–æ–≤ */
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 12px;
            margin: 8px 0;
            border-radius: 8px;
            width: calc(100% - 24px); /* –£—á–∏—Ç—ã–≤–∞–µ–º –ø–∞–¥–¥–∏–Ω–≥ */
            font-size: 15px;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            box-shadow: inset 0 2px 5px var(--shadow-light); /* –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Ç–µ–Ω—å */
        }
        input::placeholder {
            color: var(--accent-gray); /* –¶–≤–µ—Ç –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞ */
            opacity: 0.8;
        }
        input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(122, 162, 247, 0.3); /* –ì–æ–ª—É–±–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞ */
        }
        input:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            background-color: #1e1f29; /* –ß—É—Ç—å —Ç–µ–º–Ω–µ–µ —Ñ–æ–Ω –¥–ª—è disabled */
        }

        /* –ò–Ω—Ñ–æ –æ –±–æ—Ç–µ */
        #botInfo {
            background-color: var(--bg-color); /* –¢–µ–º–Ω–µ–µ —Ñ–æ–Ω */
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 5px solid var(--accent-blue); /* –ë–æ–ª–µ–µ —Ç–æ–ª—Å—Ç–∞—è –ø–æ–ª–æ—Å–∫–∞ */
            box-shadow: 0 5px 15px var(--shadow-medium);
            position: relative;
        }
        #botInfo h3 {
            border-bottom: none;
            margin-top: 0;
            padding-bottom: 0;
            display: flex;
            align-items: center;
            color: var(--accent-blue); /* –¶–≤–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏–Ω—Ñ–æ */
        }
        #botInfo h3 i {
            margin-right: 10px;
            color: var(--accent-blue);
        }
        #botInfo p { margin: 8px 0; font-size: 15px; }
        #botInfo strong { color: white; font-weight: 600; }

        .controls-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px; /* –û—Ç—Å—Ç—É–ø—ã –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ —Å–µ—Ç–∫–∏ */
            margin-bottom: 20px;
        }

        /* –õ–æ–≥–∏ */
        #logs {
            background: var(--bg-color);
            color: var(--text-color);
            padding: 18px;
            height: 250px;
            overflow-y: auto;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            font-family: 'Fira Code', 'Courier New', Courier, monospace; /* –ë–æ–ª–µ–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–π —à—Ä–∏—Ñ—Ç */
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 15px;
            box-shadow: inset 0 2px 8px var(--shadow-light);
            word-break: break-all; /* –ü–µ—Ä–µ–Ω–æ—Å –¥–ª–∏–Ω–Ω—ã—Ö —Å–ª–æ–≤ */
        }
        /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è WebKit) */
        #logs::-webkit-scrollbar {
            width: 8px;
        }
        #logs::-webkit-scrollbar-track {
            background: var(--bg-color);
            border-radius: 10px;
        }
        #logs::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 10px;
            transition: background 0.3s ease;
        }
        #logs::-webkit-scrollbar-thumb:hover {
            background: var(--accent-gray);
        }

        /* –¶–≤–µ—Ç–æ–≤–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤ */
        .log-status { color: var(--accent-blue); font-weight: 500; }
        .log-info { color: var(--accent-green); }
        .log-error { color: var(--accent-red); font-weight: 600; }
        .log-chat { color: var(--text-color); } /* –î–µ—Ñ–æ–ª—Ç–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è —á–∞—Ç–∞ */


        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000; /* –£–≤–µ–ª–∏—á–∏–º z-index */
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: var(--modal-bg);
            backdrop-filter: blur(8px); /* –ë–æ–ª–µ–µ —Å–∏–ª—å–Ω—ã–π –±–ª—é—Ä */
            animation: modalFadeIn 0.3s ease-out;
        }

        .modal-content {
            background-color: var(--surface-color);
            margin: 10% auto; /* –ß—É—Ç—å –≤—ã—à–µ */
            padding: 30px;
            border: 1px solid var(--border-color);
            width: 90%;
            max-width: 500px; /* –£–≤–µ–ª–∏—á–∏–º —à–∏—Ä–∏–Ω—É –¥–ª—è –ª—É—á—à–µ–≥–æ –≤–∏–¥–∞ */
            border-radius: 15px; /* –ë–æ–ª–µ–µ —Å–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ */
            position: relative;
            box-shadow: 0 10px 25px var(--shadow-heavy);
            display: flex;
            flex-direction: column;
            gap: 15px;
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes modalSlideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }


        .close {
            color: var(--border-color);
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 32px; /* –ß—É—Ç—å –∫—Ä—É–ø–Ω–µ–µ */
            font-weight: normal;
            cursor: pointer;
            transition: color 0.2s ease, transform 0.2s ease;
        }
        .close:hover {
            color: var(--accent-red);
            transform: rotate(90deg);
        }

        /* –¢–∞–±—ã */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 25px;
            background-color: var(--bg-color); /* –§–æ–Ω –¥–ª—è –≤–∫–ª–∞–¥–æ–∫ */
            border-radius: 8px;
            box-shadow: 0 2px 8px var(--shadow-light);
            padding: 5px;
        }
        .tab-button {
            flex-grow: 1; /* –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ */
            background-color: transparent;
            border: none;
            color: var(--text-color);
            padding: 12px 20px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            margin: 0;
            border-radius: 6px; /* –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ */
            text-align: center;
        }
        .tab-button:hover:not(.active) {
            background-color: rgba(65, 72, 104, 0.2); /* –õ–µ–≥–∫–∏–π —Ñ–æ–Ω –Ω–∞ —Ö–æ–≤–µ—Ä–µ */
            transform: none; /* –£–±—Ä–∞—Ç—å translateY –¥–ª—è —Ç–∞–±–æ–≤ */
            color: white;
        }
        .tab-button.active {
            color: var(--accent-blue);
            border-bottom-color: var(--accent-blue);
            background-color: var(--surface-color); /* –§–æ–Ω –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏ */
            box-shadow: 0 2px 10px var(--shadow-medium);
            font-weight: 600;
        }
        .tab-content {
            display: none;
            padding-top: 15px; /* –û—Ç—Å—Ç—É–ø –æ—Ç —Ç–∞–±–æ–≤ */
        }
        .tab-content.active { display: block; }

        /* –ü–ª–∞–≥–∏–Ω—ã */
        .plugins-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); /* –ß—É—Ç—å —à–∏—Ä–µ –∫–∞—Ä—Ç–æ—á–∫–∏ */
            gap: 25px; /* –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π –æ—Ç—Å—Ç—É–ø */
            margin-top: 20px;
        }
        .plugin-card {
            background-color: var(--bg-color); /* –¢–µ–º–Ω–µ–µ —Ñ–æ–Ω */
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            gap: 12px;
            transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
            position: relative;
            box-shadow: 0 5px 15px var(--shadow-light);
        }
        .plugin-card:hover {
            transform: translateY(-8px); /* –ë–æ–ª–µ–µ –∑–∞–º–µ—Ç–Ω—ã–π –ø–æ–¥—ä–µ–º */
            box-shadow: 0 12px 25px var(--shadow-medium);
            border-color: var(--accent-blue); /* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ä–∞–º–∫–∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
        }
        .plugin-card.active {
            border-left: 5px solid var(--accent-green); /* –ó–µ–ª–µ–Ω–∞—è –ø–æ–ª–æ—Å–∫–∞ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö */
            background-color: #2a3044; /* –ß—É—Ç—å —Ç–µ–º–Ω–µ–µ —Ñ–æ–Ω –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π */
            box-shadow: 0 8px 20px var(--shadow-medium);
        }
        .plugin-card h4 {
            margin: 0 0 5px 0;
            color: white;
            border-bottom: none;
            padding-bottom: 0;
            font-size: 1.2em;
        }
        .plugin-card p {
            margin: 0;
            font-size: 14px;
            flex-grow: 1;
            line-height: 1.6;
            color: #a9b1d6; /* –ë–æ–ª–µ–µ –º—è–≥–∫–∏–π —Ü–≤–µ—Ç –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è */
        }
        .plugin-toggle-btn {
            width: calc(100% - 16px); /* –î–ª—è —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è */
            margin-left: 0;
            margin-right: 0;
            align-self: center;
        }
        .plugin-toggle-btn.load { background-color: var(--accent-green); }
        .plugin-toggle-btn.remove { background-color: var(--accent-red); }

        .plugin-settings-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 20px; /* –ö—Ä—É–ø–Ω–µ–µ */
            color: var(--border-color);
            cursor: pointer;
            transition: color 0.2s, transform 0.2s;
            display: none;
        }
        .plugin-settings-btn:hover {
            color: var(--accent-blue);
            transform: rotate(90deg); /* –ü–ª–∞–≤–Ω–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ */
        }
        .plugin-card.active .plugin-settings-btn { display: block; }

        .settings-field {
            display: flex;
            flex-direction: column;
            margin-bottom: 10px;
        }
        .settings-field label {
            margin-bottom: 5px;
            font-size: 14px;
            color: #a9b1d6;
            font-weight: 500;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ "–ß—Ç–æ –Ω–æ–≤–æ–≥–æ" */
        #whatsNewModal .modal-content {
            max-width: 600px; /* –ß—É—Ç—å —à–∏—Ä–µ –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–º–∏—Ç–æ–≤ */
            height: 70vh; /* –ó–∞–¥–∞–¥–∏–º –≤—ã—Å–æ—Ç—É */
        }

        #whatsNewCommits {
            overflow-y: auto; /* –°–∫—Ä–æ–ª–ª –¥–ª—è –∫–æ–º–º–∏—Ç–æ–≤ */
            padding-right: 10px; /* –û—Ç—Å—Ç—É–ø –æ—Ç —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ */
            flex-grow: 1; /* –ß—Ç–æ–±—ã –∑–∞–Ω–∏–º–∞–ª –¥–æ—Å—Ç—É–ø–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ */
            margin-top: 15px;
            border-top: 1px solid var(--border-color);
            padding-top: 15px;
        }

        #whatsNewCommits::-webkit-scrollbar {
            width: 8px;
        }
        #whatsNewCommits::-webkit-scrollbar-track {
            background: var(--bg-color);
            border-radius: 10px;
        }
        #whatsNewCommits::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 10px;
            transition: background 0.3s ease;
        }
        #whatsNewCommits::-webkit-scrollbar-thumb:hover {
            background: var(--accent-gray);
        }

        .commit-item {
            background-color: var(--bg-color);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid var(--accent-cyan); /* –¶–≤–µ—Ç–Ω–∞—è –ø–æ–ª–æ—Å–∫–∞ */
            box-shadow: 0 2px 10px var(--shadow-light);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .commit-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px var(--shadow-medium);
        }
        .commit-item p {
            margin: 0;
            font-size: 14px;
            line-height: 1.5;
        }
        .commit-item p strong {
            color: white;
            font-weight: 600;
        }
        .commit-item .commit-message {
            font-size: 16px;
            color: var(--text-color);
            margin-bottom: 8px;
        }
        .commit-item .commit-meta {
            font-size: 12px;
            color: var(--accent-gray);
        }
        .commit-item .commit-meta a {
            color: var(--accent-blue);
            text-decoration: none;
            transition: color 0.2s ease;
        }
        .commit-item .commit-meta a:hover {
            color: var(--accent-cyan);
            text-decoration: underline;
        }
        .commit-item .loading-text {
            text-align: center;
            font-style: italic;
            color: var(--accent-gray);
        }


        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .container { padding: 20px; margin-top: 10px; }
            h1 { font-size: 2em; margin-bottom: 20px; }
            .controls-grid { flex-direction: column; gap: 5px; }
            button { width: calc(100% - 16px); margin: 5px 0; }
            .tabs { flex-direction: column; }
            .tab-button { border-bottom: none; border-left: 3px solid transparent; text-align: left; }
            .tab-button.active { border-bottom-color: transparent; border-left-color: var(--accent-blue); }
            .modal-content { margin: 10% auto; padding: 20px; }
            .plugins-grid { grid-template-columns: 1fr; }
        }

        /* Documentation Specific Styles */
        #pluginDocModal .modal-content {
            max-width: 700px;
            height: 80vh; /* Adjust height for content */
            overflow-y: auto; /* Enable scrolling for documentation */
            gap: 10px;
        }
        #pluginDocModal .modal-content::-webkit-scrollbar {
            width: 8px;
        }
        #pluginDocModal .modal-content::-webkit-scrollbar-track {
            background: var(--bg-color);
            border-radius: 10px;
        }
        #pluginDocModal .modal-content::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 10px;
            transition: background 0.3s ease;
        }
        #pluginDocModal .modal-content::-webkit-scrollbar-thumb:hover {
            background: var(--accent-gray);
        }

        .documentation-content {
            line-height: 1.7;
            font-size: 15px;
            padding-right: 10px; /* Space for scrollbar */
        }
        .documentation-content h2, .documentation-content h3 {
            border-bottom: 1px dashed var(--border-color); /* Lighter border for doc headers */
            padding-bottom: 8px;
            margin-top: 25px;
            margin-bottom: 15px;
            color: var(--accent-blue);
            font-weight: 600;
        }
        .documentation-content p {
            margin-bottom: 10px;
        }
        .documentation-content code, .documentation-content pre {
            font-family: 'Fira Code', 'Courier New', Courier, monospace;
            background-color: var(--bg-color);
            border-radius: 6px;
            padding: 2px 6px;
            font-size: 0.95em;
        }
        .documentation-content pre {
            padding: 15px;
            overflow-x: auto;
            border: 1px solid var(--border-color);
            box-shadow: inset 0 1px 5px var(--shadow-light);
            margin: 15px 0;
            line-height: 1.5;
        }
        .doc-keyword { color: var(--doc-keyword); font-weight: 500; }
        .doc-variable { color: var(--doc-variable); }
        .doc-string { color: var(--doc-string); }
        .doc-comment { color: var(--doc-comment); }
        .doc-json-key { color: var(--doc-json-key); font-weight: 500; }
        .doc-type { color: var(--accent-cyan); font-weight: 500; } /* For chat types */
        .doc-important { color: var(--accent-red); font-weight: 600; }
    </style>
</head>
<body>

<div class="container">
    <h1>BotMine ü§ñ</h1>
    <div class="tabs">
        <button class="tab-button active" onclick="openTab(event, 'main')"><i class="fa-solid fa-house"></i> –ì–ª–∞–≤–Ω–∞—è</button>
        <button class="tab-button" onclick="openTab(event, 'plugins')"><i class="fa-solid fa-puzzle-piece"></i> –ü–ª–∞–≥–∏–Ω—ã</button>
    </div>

    <div id="main" class="tab-content active">
        <div id="botInfo">
            <h3><i class="fa-solid fa-robot"></i> –í–∞—à —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –±–æ—Ç:</h3>
            <p>–ù–∏–∫: <strong id="botNick">–Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω</strong></p>
            <p>–°–µ—Ä–≤–µ—Ä: <strong id="botServer">–Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω</strong></p>
        </div>
        <div>
            <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞–º–∏</h3>
            <div class="controls-grid">
                <button id="startBot"><i class="fa-solid fa-play"></i> –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞</button>
                <button id="stopBot" disabled><i class="fa-solid fa-stop"></i> –í—ã–∫–ª—é—á–∏—Ç—å –±–æ—Ç–∞</button>
                <button id="openModalBtn"><i class="fa-solid fa-pencil"></i> –°–æ–∑–¥–∞—Ç—å/–ò–∑–º–µ–Ω–∏—Ç—å</button>
                <button id="exportBotDataBtn"><i class="fa-solid fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–∞</button>
                <input type="file" id="importFileInput" accept=".json" style="display: none;">
                <button id="importBotDataBtn"><i class="fa-solid fa-upload"></i> –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–∞</button>
                <button id="whatsNewBtn"><i class="fa-solid fa-sparkles"></i> –ß—Ç–æ –Ω–æ–≤–æ–≥–æ?</button> <!-- –ù–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ -->
            </div>
        </div>
        <h2><i class="fa-solid fa-comments"></i> –ò–≥—Ä–æ–≤–æ–π —á–∞—Ç:</h2>
        <div id="logs"></div>

        <!-- –ü–µ—Ä–µ–º–µ—â–µ–Ω–Ω—ã–π –±–ª–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π -->
        <div>
            <h3><i class="fa-solid fa-message"></i> –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π</h3>
            <input id="message" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." disabled>
            <button id="sendMessage" disabled><i class="fa-solid fa-paper-plane"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
        </div>
    </div>

    <div id="plugins" class="tab-content">
        <h3>–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã</h3>
        <div class="plugins-grid"></div>
        <hr style="border-color: var(--border-color); margin: 30px 0;">
        <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–∏–º–∏ –ø–ª–∞–≥–∏–Ω–∞–º–∏</h3>
        <div class="controls-grid" style="justify-content: center; margin-top: 15px;">
            <button id="addMyPluginBtn" style="background-color: var(--accent-purple);"><i class="fa-solid fa-plus-circle"></i> –î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π –ø–ª–∞–≥–∏–Ω</button>
            <button id="howToCreatePluginBtn" style="background-color: var(--accent-orange);"><i class="fa-solid fa-book"></i> –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π –ø–ª–∞–≥–∏–Ω?</button>
        </div>
        <input type="file" id="pluginZipInput" accept=".zip" style="display: none;">
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="botModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>–°–æ–∑–¥–∞–Ω–∏–µ / –ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–æ—Ç–∞</h2>
            <input type="text" id="modal_username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (username)">
            <input type="password" id="modal_password" placeholder="–ü–∞—Ä–æ–ª—å (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
            <input type="text" id="modal_server" placeholder="–ê–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ (host)">
            <button id="createBotBtn" style="background-color: var(--accent-green);"><i class="fa-solid fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
        </div>
    </div>
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="settingsModalTitle">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–∞–≥–∏–Ω–∞</h2>
            <div id="settingsModalBody"></div>
            <button id="saveSettingsBtn" style="background-color: var(--accent-green);"><i class="fa-solid fa-floppy-disk"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <!-- –ù–æ–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è "–ß—Ç–æ –Ω–æ–≤–æ–≥–æ" -->
    <div id="whatsNewModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeWhatsNewModal">&times;</span>
            <h2><i class="fa-solid fa-sparkles"></i> –ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ BotMine?</h2>
            <div id="whatsNewCommits">
                <p class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π...</p>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ –ø–ª–∞–≥–∏–Ω–∞–º -->
    <div id="pluginDocModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closePluginDocModal">&times;</span>
            <h2><i class="fa-solid fa-book"></i> –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π –ø–ª–∞–≥–∏–Ω?</h2>
            <div class="documentation-content">
                <p>–ü—Ä–∏–≤–µ—Ç, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫! –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–æ –∏ –ª–µ–≥–∫–æ —Å–¥–µ–ª–∞—Ç—å —Ç–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–ª–∞–≥–∏–Ω.</p>
                <p>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–ª–∞–≥–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ç–∞–∫–æ–π:</p>
                <pre><code>
<span class="doc-keyword">class</span> <span class="doc-variable">NamePlugin</span> {
    <span class="doc-keyword">constructor</span>(<span class="doc-variable">bot</span>, <span class="doc-variable">botInfo</span>, <span class="doc-variable">botAPI</span>) {
        <span class="doc-keyword">this</span>.<span class="doc-variable">botInfo</span> = <span class="doc-variable">botInfo</span>;
        <span class="doc-keyword">this</span>.<span class="doc-variable">botAPI</span> = <span class="doc-variable">botAPI</span>;
        <span class="doc-keyword">this</span>.<span class="doc-variable">bot</span> = <span class="doc-variable">bot</span>;
        <span class="doc-variable">console</span>.<span class="doc-variable">log</span>(<span class="doc-string">'[NamePlugin] –ü–ª–∞–≥–∏–Ω –∑–∞–≥—Ä—É–∂–µ–Ω.'</span>);
    }

    <span class="doc-variable">onMessage</span>(<span class="doc-variable">message</span>, <span class="doc-variable">json</span>) {
        <span class="doc-comment">// –¢–≤–æ–π –∫–æ–¥ –∑–¥–µ—Å—å</span>
    }
}

<span class="doc-keyword">module</span>.<span class="doc-variable">exports</span> = <span class="doc-variable">NamePlugin</span>;
                </code></pre>

                <h3>–î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä–µ–º—Å—è</h3>
                <p>–í –º–µ—Ç–æ–¥–µ <span class="doc-variable"><code>onMessage</code></span> —Ç–µ–±–µ –±—É–¥–µ—Ç –¥–∞–≤–∞—Ç—å—Å—è —Ç–µ–∫—Å—Ç –∏–∑ —á–∞—Ç–∞ (–∫–æ—Ç–æ—Ä—ã–π –≤–∏–¥–∏—Ç –±–æ—Ç).</p>
                <p>–ü—Ä–∏–º–µ—Ä: <code>‚Ä∫ –ò–≥—Ä–æ–∫ –í–ª–∞–¥–µ–ª–µ—Ü Dream123067 –∑–∞—à–µ–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä.</code></p>
                <p>–≠—Ç–æ—Ç —Ç–µ–∫—Å—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π <span class="doc-variable"><code>message</code></span>. –¢–∞–∫–∂–µ —É —Ç–µ–±—è –µ—Å—Ç—å <span class="doc-variable"><code>this.botAPI</code></span>. –¢–∞–º –≤—Å–µ —Å–∞–º–æ–µ –Ω—É–∂–Ω–æ–µ:</p>

                <p><span class="doc-variable"><code>this.botAPI.sendMessage()</code></span> ‚Äì —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–µ–±–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç. –£ –Ω–µ–≥–æ –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: <span class="doc-variable"><code>bot</code></span>, <span class="doc-variable"><code>type</code></span>, <span class="doc-variable"><code>text</code></span>, <span class="doc-variable"><code>nick</code></span>. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</p>
                <pre><code>
<span class="doc-variable">this</span>.<span class="doc-variable">botAPI</span>.<span class="doc-variable">sendMessage</span>(<span class="doc-variable">this</span>.<span class="doc-variable">bot</span>, <span class="doc-string">'clan'</span>, <span class="doc-string">"–ü—Ä–∏–≤–µ—Ç!"</span>);
                </code></pre>
                <p>–≠—Ç–æ—Ç –∫–æ–¥ –Ω–∞–ø–∏—à–µ—Ç –≤ –∫–ª–∞–Ω–æ–≤—ã–π —á–∞—Ç "–ü—Ä–∏–≤–µ—Ç!". –¢–∏–ø—ã —á–∞—Ç–æ–≤:</p>
                <ul>
                    <li><span class="doc-type"><code>global</code></span> - –≥–ª–æ–±–∞–ª—å–Ω—ã–π</li>
                    <li><span class="doc-type"><code>local</code></span> - –ª–æ–∫–∞–ª—å–Ω—ã–π</li>
                    <li><span class="doc-type"><code>private</code></span> - –ø—Ä–∏–≤–∞—Ç–Ω—ã–π</li>
                    <li><span class="doc-type"><code>cmd</code></span> - –∫–æ–º–∞–Ω–¥–∞ (–æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –≤ –∫–æ–Ω—Å–æ–ª—å –±–æ—Ç–∞)</li>
                    <li><span class="doc-type"><code>clan</code></span> - –∫–ª–∞–Ω–æ–≤—ã–π</li>
                </ul>
                <p>–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å <span class="doc-type"><code>private</code></span> - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å–ª–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–æ–±–∞–≤—å –Ω–∏–∫ –∏–≥—Ä–æ–∫–∞. –ü—Ä–∏–º–µ—Ä:</p>
                <pre><code>
<span class="doc-variable">this</span>.<span class="doc-variable">botAPI</span>.<span class="doc-variable">sendMessage</span>(<span class="doc-variable">this</span>.<span class="doc-variable">bot</span>, <span class="doc-string">'private'</span>, <span class="doc-string">"–ö–∞–∫ –¥–µ–ª–∞?"</span>, <span class="doc-variable">nick</span>);
                </code></pre>

                <h3>–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –Ω–∏–∫ –∏–≥—Ä–æ–∫–∞?</h3>
                <p>–ò—Å–ø–æ–ª—å–∑—É–π <span class="doc-variable"><code>botAPI</code></span>!</p>
                <pre><code>
<span class="doc-variable">this</span>.<span class="doc-variable">botAPI</span>.<span class="doc-variable">getNick</span>(<span class="doc-variable">text</span>, <span class="doc-variable">json</span>); <span class="doc-comment">// –í–µ—Ä–Ω–µ—Ç –Ω–∞—Å—Ç–æ—è—â–∏–π –Ω–∏–∫ –∏–≥—Ä–æ–∫–∞</span>
                </code></pre>

                <h3>–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –¢–∏–ø —á–∞—Ç–∞?</h3>
                <pre><code>
<span class="doc-variable">this</span>.<span class="doc-variable">botAPI</span>.<span class="doc-variable">getType</span>(<span class="doc-variable">text</span>);
                </code></pre>

                <h3>–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –¢–µ–∫—Å—Ç?</h3>
                <p>–£–±–∏—Ä–∞–µ—Ç –ø—Ä–µ—Ñ–∏–∫—Å—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, <code>[G] Semleks Dream123067 -> –¢–ï–°–¢</code> –¥–∞–µ—Ç: <code>–¢–ï–°–¢</code>).</p>
                <pre><code>
<span class="doc-variable">this</span>.<span class="doc-variable">botAPI</span>.<span class="doc-variable">getText</span>(<span class="doc-variable">text</span>);
                </code></pre>

                <h3>–ú–∞–Ω–∏—Ñ–µ—Å—Ç –ø–ª–∞–≥–∏–Ω–∞</h3>
                <p>–£ –∫–∞–∂–¥–æ–≥–æ –ø–ª–∞–≥–∏–Ω–∞ <span class="doc-important">–î–û–õ–ñ–ï–ù –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û</span> –±—ã—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç! –û–Ω –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:</p>
                <pre><code>
{
  <span class="doc-json-key">"name"</span>: <span class="doc-string">"Name"</span>,
  <span class="doc-json-key">"description"</span>: <span class="doc-string">"–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–ª–∞–≥–∏–Ω"</span>,
  <span class="doc-json-key">"defaultSettings"</span>: {
    <span class="doc-json-key">"message"</span>: {
      <span class="doc-json-key">"label"</span>: <span class="doc-string">"–ù–∞–ø–∏—à–∏ .."</span>,
      <span class="doc-json-key">"value"</span>: <span class="doc-string">""</span>
    }
  }
}
                </code></pre>
                <ul>
                    <li><span class="doc-json-key"><code>name</code></span> - –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–ª–∞–≥–∏–Ω–∞.</li>
                    <li><span class="doc-json-key"><code>description</code></span> - –æ–ø–∏—Å–∞–Ω–∏–µ.</li>
                    <li><span class="doc-json-key"><code>message</code></span> - –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —á—Ç–æ –¥–æ–ª–∂–µ–Ω –≤–≤–µ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—ç—Ç–æ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ –∏–º—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, "greetingText").</li>
                    <li><span class="doc-json-key"><code>label</code></span> - —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è, –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–¢–∏–ø–∞ –≤–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ").</li>
                    <li><span class="doc-json-key"><code>value</code></span> - –±—É–¥–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, –≤–≤–µ–¥–µ–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.</li>
                </ul>

                <h3>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–∞–≥–∏–Ω–∞)?</h3>
                <pre><code>
<span class="doc-variable">this</span>.<span class="doc-variable">botInfo</span>.<span class="doc-variable">pluginSettings</span>.<span class="doc-variable">Hi</span>?.<span class="doc-variable">message</span>?.<span class="doc-variable">value</span>
                </code></pre>
                <p>–í–º–µ—Å—Ç–æ <span class="doc-variable"><code>Hi</code></span> –ø–æ–¥—Å—Ç–∞–≤—å—Ç–µ <span class="doc-important">–Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –ø–ª–∞–≥–∏–Ω–∞</span> (–∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ –ø–æ–ª–µ <span class="doc-json-key"><code>"name"</code></span> –∏–∑ <span class="doc-variable"><code>manifest.json</code></span>).</p>
                <p>–í–º–µ—Å—Ç–æ <span class="doc-variable"><code>message</code></span> –ø–æ–¥—Å—Ç–∞–≤—å—Ç–µ <span class="doc-important">–Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏</span> –∏–∑ <span class="doc-json-key"><code>"defaultSettings"</code></span> (–Ω–∞–ø—Ä–∏–º–µ—Ä, "greetingText").</p>

                <p>–ß—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–ª–∞–≥–∏–Ω, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å <span class="doc-important">ZIP-–∞—Ä—Ö–∏–≤</span>. –í–Ω—É—Ç—Ä–∏ –∞—Ä—Ö–∏–≤–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ —Ñ–∞–π–ª–æ–≤, –Ω–æ <span class="doc-important">–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ú–ò</span> –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–≤–∞ —Ñ–∞–π–ª–∞ –≤ –∫–æ—Ä–Ω–µ –∞—Ä—Ö–∏–≤–∞:</p>
                <ul>
                    <li><span class="doc-important"><code>index.js</code></span> - –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø–ª–∞–≥–∏–Ω–∞ —Å –≤–∞—à–µ–π –ª–æ–≥–∏–∫–æ–π.</li>
                    <li><span class="doc-important"><code>manifest.json</code></span> - —Ñ–∞–π–ª —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–ª–∞–≥–∏–Ω–∞.</li>
                </ul>
            </div>
        </div>
    </div>

</div>

<script>
    let ws;
    let botData = {
        nick: "",
        server: "",
        activatedPlugins: [],
        pluginSettings: {},
        commitWatcherSettings: {},
        botIsRunning: false
    };
    let availablePlugins = {};

    const logsDiv = document.getElementById("logs");
    const botModal = document.getElementById("botModal");
    const settingsModal = document.getElementById("settingsModal");
    const whatsNewModal = document.getElementById("whatsNewModal"); // –ù–æ–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    const openBotModalBtn = document.getElementById("openModalBtn");
    const exportBotDataBtn = document.getElementById("exportBotDataBtn");
    const importBotDataBtn = document.getElementById("importBotDataBtn");
    const importFileInput = document.getElementById("importFileInput");
    const whatsNewBtn = document.getElementById("whatsNewBtn"); // –ù–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞

    const startBotBtn = document.getElementById("startBot");
    const stopBotBtn = document.getElementById("stopBot");
    const messageInput = document.getElementById("message");
    const sendMessageBtn = document.getElementById("sendMessage");
    const whatsNewCommitsDiv = document.getElementById("whatsNewCommits"); // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–æ–º–º–∏—Ç–æ–≤

    // New plugin upload elements
    const addMyPluginBtn = document.getElementById("addMyPluginBtn");
    const howToCreatePluginBtn = document.getElementById("howToCreatePluginBtn");
    const pluginZipInput = document.getElementById("pluginZipInput");
    const pluginDocModal = document.getElementById("pluginDocModal"); // New modal

    // --- WebSocket ---
    function connect() {
        if (ws && ws.readyState === WebSocket.OPEN) return;
        ws = new WebSocket("ws://localhost:3001");

        ws.onopen = () => logWithType("status", "WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω.");
        ws.onmessage = (event) => {
            try {
                const data = JSON.parse(event.data);

                if (data.type === "botInfo") {
                    botData = JSON.parse(JSON.stringify({ ...botData, ...data.data }));
                    document.getElementById("botNick").textContent = botData.nick || "–Ω–µ –∑–∞–¥–∞–Ω";
                    document.getElementById("botServer").textContent = botData.server || "–Ω–µ –∑–∞–¥–∞–Ω";
                    logWithType("info", `–ó–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ: –ù–∏–∫ - ${botData.nick}, –°–µ—Ä–≤–µ—Ä - ${botData.server}`);
                    updatePluginButtons();
                    updateBotControlButtons();
                } else if (data.type === "availablePlugins") {
                    availablePlugins = data.data;
                    renderPlugins(availablePlugins);
                } else if (data.type === "chat") {
                    logWithType("chat", data.message);
                } else if (data.type === "status") {
                    let logType = "status";
                    if (data.message.includes("–û—à–∏–±–∫–∞") || data.message.includes("–ö–∏–∫–Ω—É—Ç")) {
                        logType = "error";
                    }
                    logWithType(logType, data.message);
                } else if (data.type === "pluginUploadStatus") { // Handle plugin upload status
                    if (data.success) {
                        logWithType("info", data.message);
                    } else {
                        logWithType("error", data.message);
                    }
                }
            } catch (e) {
                logWithType("error", "–ü–æ–ª—É—á–µ–Ω–æ –Ω–µ-JSON —Å–æ–æ–±—â–µ–Ω–∏–µ: " + event.data);
                console.error("Parse error:", e);
            }
        };
        ws.onclose = () => {
            logWithType("status", "WebSocket –∑–∞–∫—Ä—ã—Ç. –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ 3—Å...");
            botData.botIsRunning = false;
            updateBotControlButtons();
            setTimeout(connect, 3000);
        }
        ws.onerror = (err) => {
            logWithType("error", "–û—à–∏–±–∫–∞ WebSocket. –°–º. –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.");
            console.error("[ERROR] WebSocket error:", err);
            botData.botIsRunning = false;
            updateBotControlButtons();
        };
    }

    connect();

    // --- –õ–æ–≥–∏–∫–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI ---
    function logWithType(type, msg) {
        if (type !== "status" && type !== "error") {
            const lastLog = logsDiv.lastElementChild;
            if (lastLog && lastLog.textContent.includes("WebSocket –∑–∞–∫—Ä—ã—Ç")) {
                logsDiv.removeChild(lastLog);
            }
        }

        const span = document.createElement('span');
        span.classList.add(`log-${type}`);
        span.innerHTML = msg.replace(/</g, "&lt;").replace(/>/g, "&gt;");
        logsDiv.appendChild(span);
        logsDiv.innerHTML += "<br>";
        logsDiv.scrollTop = logsDiv.scrollHeight;
    }

    function log(msg) {
        logWithType("chat", msg);
    }

    function renderPlugins(plugins) {
        const container = document.querySelector('.plugins-grid');
        container.innerHTML = '';

        for (const pluginName in plugins) {
            const plugin = plugins[pluginName];
            const cardHTML = `
                <div class="plugin-card" data-plugin-name="${plugin.name}">
                    <i class="fa-solid fa-gear plugin-settings-btn"></i>
                    <h4>${plugin.name}</h4>
                    <p>${plugin.description}</p>
                    <button class="plugin-toggle-btn">${botData.activatedPlugins.includes(plugin.name) ? '<i class="fa-solid fa-trash"></i> –£–¥–∞–ª–∏—Ç—å' : '<i class="fa-solid fa-plus"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å'}</button>
                </div>
            `;
            container.insertAdjacentHTML('beforeend', cardHTML);
        }
        updatePluginButtons();
    }

    function updatePluginButtons() {
        document.querySelectorAll('.plugin-card').forEach(card => {
            const pluginName = card.dataset.pluginName;
            const button = card.querySelector('.plugin-toggle-btn');

            if (botData.activatedPlugins.includes(pluginName)) {
                button.innerHTML = '<i class="fa-solid fa-trash"></i> –£–¥–∞–ª–∏—Ç—å';
                button.className = 'plugin-toggle-btn remove';
                card.classList.add('active');
            } else {
                button.innerHTML = '<i class="fa-solid fa-plus"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å';
                button.className = 'plugin-toggle-btn load';
                card.classList.remove('active');
            }
        });
    }

    function updateBotControlButtons() {
        if (botData.botIsRunning) {
            startBotBtn.disabled = true;
            stopBotBtn.disabled = false;
            messageInput.disabled = false;
            sendMessageBtn.disabled = false;
        } else {
            startBotBtn.disabled = false;
            stopBotBtn.disabled = true;
            messageInput.disabled = true;
            sendMessageBtn.disabled = true;
        }
    }

    // --- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–∞–≥–∏–Ω–æ–≤ ---
    function openSettingsModal(pluginName) {
        if (!botData.pluginSettings[pluginName] && availablePlugins[pluginName] && availablePlugins[pluginName].defaultSettings) {
            botData.pluginSettings[pluginName] = JSON.parse(JSON.stringify(availablePlugins[pluginName].defaultSettings));
        }

        const settings = botData.pluginSettings[pluginName];
        document.getElementById('settingsModalTitle').textContent = `–ù–∞—Å—Ç—Ä–æ–π–∫–∏: ${pluginName}`;
        const modalBody = document.getElementById('settingsModalBody');
        modalBody.innerHTML = '';

        if (settings && Object.keys(settings).length > 0) {
            for (const key in settings) {
                const setting = settings[key];
                modalBody.innerHTML += `
                    <div class="settings-field">
                        <label for="setting_${key}">${setting.label}</label>
                        <input type="text" id="setting_${key}" name="${key}" value="${setting.value}">
                    </div>`;
            }
            document.getElementById('saveSettingsBtn').style.display = 'flex';
        } else {
            modalBody.innerHTML = '<p>–î–ª—è —ç—Ç–æ–≥–æ –ø–ª–∞–≥–∏–Ω–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫.</p>';
            document.getElementById('saveSettingsBtn').style.display = 'none';
        }
        document.getElementById('saveSettingsBtn').onclick = () => savePluginSettings(pluginName);
        settingsModal.style.display = "block";
    }

    function savePluginSettings(pluginName) {
        const newSettings = {};
        document.querySelectorAll('#settingsModalBody input').forEach(input => {
            newSettings[input.name] = input.value;
        });
        sendWsMessage('savePluginSettings', { pluginName, settings: newSettings });
        settingsModal.style.display = "none";
    }

    // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π ---
    function sendWsMessage(type, payload = {}) {
        if (!ws || ws.readyState !== WebSocket.OPEN) {
            logWithType("error", "[ERROR] WebSocket –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω. –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...");
            connect();
            return;
        }
        ws.send(JSON.stringify({ type, ...payload }));
    }

    startBotBtn.onclick = () => sendWsMessage('startBot');
    stopBotBtn.onclick = () => sendWsMessage('stopBot');

    sendMessageBtn.onclick = () => {
        if (messageInput.value.trim() && !messageInput.disabled) {
            sendWsMessage('sendMessage', { message: messageInput.value });
            messageInput.value = "";
        }
    };

    messageInput.addEventListener('keydown', (event) => {
        if (event.key === 'Enter' && !messageInput.disabled) {
            event.preventDefault();
            sendMessageBtn.click();
        }
    });

    document.getElementById("createBotBtn").onclick = () => {
        const host = document.getElementById("modal_server").value;
        const username = document.getElementById("modal_username").value;
        const password = document.getElementById("modal_password").value;
        sendWsMessage('createBot', { host, username, password });
        botModal.style.display = "none";
    };

    openBotModalBtn.onclick = () => {
        document.getElementById('modal_username').value = botData.nick || "";
        document.getElementById('modal_server').value = botData.server || "";
        document.getElementById('modal_password').value = "";
        botModal.style.display = "block";
    };

    document.querySelector('.plugins-grid').addEventListener('click', (e) => {
        const card = e.target.closest('.plugin-card');
        if (!card) return;
        const pluginName = card.dataset.pluginName;

        if (e.target.classList.contains('plugin-toggle-btn')) {
            sendWsMessage('togglePlugin', { pluginName });
        }
        if (e.target.classList.contains('plugin-settings-btn')) {
            openSettingsModal(pluginName);
        }
    });

    // --- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —ç–∫—Å–ø–æ—Ä—Ç–∞/–∏–º–ø–æ—Ä—Ç–∞ ---
    exportBotDataBtn.onclick = async () => { // –î–æ–±–∞–≤–ª–µ–Ω–æ async
        logWithType("status", "–ü–æ–ø—ã—Ç–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª main.json...");
        try {
            const response = await fetch('/export-bot-data'); // –ò—Å–ø–æ–ª—å–∑—É–µ–º fetch
            if (response.ok) {
                const blob = await response.blob(); // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ Blob
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = 'main.json';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url); // –û—á–∏—â–∞–µ–º URL
                document.body.removeChild(a);
                logWithType("info", "–§–∞–π–ª main.json —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω.");
            } else {
                const errorMessage = await response.text(); // –ß–∏—Ç–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Å —Å–µ—Ä–≤–µ—Ä–∞
                logWithType("error", `[ERROR] –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞: ${errorMessage}. –í–æ–∑–º–æ–∂–Ω–æ, —Ñ–∞–π–ª main.json –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω.`);
                console.error("[ERROR] Server responded with an error during export:", response.status, errorMessage);
            }
        } catch (error) {
            logWithType("error", `[ERROR] –ü—Ä–æ–∏–∑–æ—à–ª–∞ —Å–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ: ${error.message}`);
            console.error("[ERROR] Network error during export:", error);
        }
    };

    importBotDataBtn.onclick = () => {
        importFileInput.click();
    };

    importFileInput.addEventListener('change', (event) => {
        const file = event.target.files[0];
        if (!file) {
            return;
        }

        if (file.type !== 'application/json' && !file.name.endsWith('.json')) {
            logWithType("error", "[ERROR] –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.");
            event.target.value = '';
            return;
        }

        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                JSON.parse(e.target.result);
                sendWsMessage('importBotData', { content: e.target.result });
                logWithType("status", "–§–∞–π–ª main.json –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞.");
            } catch (error) {
                logWithType("error", "[ERROR] –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON —Ñ–∞–π–ª–∞: " + error.message);
            }
            event.target.value = '';
        };
        reader.onerror = (error) => {
            logWithType("error", "[ERROR] –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞: " + error.message);
        };
        reader.readAsText(file);
    });

    // New Plugin Management Event Listeners
    addMyPluginBtn.onclick = () => {
        pluginZipInput.click();
    };

    howToCreatePluginBtn.onclick = () => {
        pluginDocModal.style.display = "block";
    };

    pluginZipInput.addEventListener('change', (event) => {
        const file = event.target.files[0];
        if (!file) {
            return;
        }

        if (file.type !== 'application/x-zip-compressed' && !file.name.endsWith('.zip')) {
            logWithType("error", "[ERROR] –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ ZIP.");
            event.target.value = '';
            return;
        }

        const reader = new FileReader();
        reader.onload = (e) => {
            // Convert ArrayBuffer to binary string, then to Base64
            const binaryString = new Uint8Array(e.target.result).reduce((data, byte) => data + String.fromCharCode(byte), '');
            const base64Content = btoa(binaryString);
            sendWsMessage('uploadPluginZip', { fileName: file.name, content: base64Content });
            logWithType("status", `–û—Ç–ø—Ä–∞–≤–∫–∞ –ø–ª–∞–≥–∏–Ω–∞ "${file.name}" –Ω–∞ —Å–µ—Ä–≤–µ—Ä...`);
            event.target.value = ''; // Clear the input
        };
        reader.onerror = (error) => {
            logWithType("error", "[ERROR] –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è ZIP —Ñ–∞–π–ª–∞: " + error.message);
        };
        reader.readAsArrayBuffer(file); // Read as ArrayBuffer to convert to Base64
    });

    // --- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª "–ß—Ç–æ –Ω–æ–≤–æ–≥–æ" ---
    whatsNewBtn.onclick = () => {
        whatsNewModal.style.display = "block";
        fetchCommits();
    };

    async function fetchCommits() {
        whatsNewCommitsDiv.innerHTML = '<p class="loading-text"><i class="fa-solid fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π...</p>';
        try {
            const response = await fetch('/api/commits');
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const commits = await response.json();
            renderCommits(commits);
        } catch (error) {
            whatsNewCommitsDiv.innerHTML = `<p class="loading-text log-error"><i class="fa-solid fa-triangle-exclamation"></i> –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: ${error.message}</p>`;
            console.error("Failed to fetch commits:", error);
        }
    }

    function renderCommits(commits) {
        whatsNewCommitsDiv.innerHTML = '';
        if (commits.length === 0) {
            whatsNewCommitsDiv.innerHTML = '<p class="loading-text">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π.</p>';
            return;
        }

        commits.forEach(commit => {
            const commitDate = new Date(commit.date).toLocaleDateString('ru-RU', {
                year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit'
            });
            const commitItem = `
                <div class="commit-item">
                    <p class="commit-message"><strong><i class="fa-solid fa-code-branch"></i> ${commit.message}</strong></p>
                    <p class="commit-meta">
                        <i class="fa-solid fa-user"></i> –ê–≤—Ç–æ—Ä: <a href="${commit.authorUrl}" target="_blank">${commit.author}</a><br>
                        <i class="fa-solid fa-calendar-alt"></i> –î–∞—Ç–∞: ${commitDate}<br>
                        <a href="${commit.commitUrl}" target="_blank"><i class="fa-solid fa-link"></i> –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–º–º–∏—Ç</a>
                    </p>
                </div>
            `;
            whatsNewCommitsDiv.insertAdjacentHTML('beforeend', commitItem);
        });
    }

    // --- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –∏ –≤–∫–ª–∞–¥–∫–∏ ---
    botModal.querySelector(".close").onclick = () => botModal.style.display = "none";
    settingsModal.querySelector(".close").onclick = () => settingsModal.style.display = "none";
    document.getElementById("closeWhatsNewModal").onclick = () => whatsNewModal.style.display = "none"; // –ó–∞–∫—Ä—ã—Ç–∏–µ –Ω–æ–≤–æ–≥–æ –º–æ–¥–∞–ª–∞
    document.getElementById("closePluginDocModal").onclick = () => pluginDocModal.style.display = "none"; // Close new plugin doc modal

    window.onclick = (event) => {
        if (event.target == botModal) botModal.style.display = "none";
        if (event.target == settingsModal) settingsModal.style.display = "none";
        if (event.target == whatsNewModal) whatsNewModal.style.display = "none";
        if (event.target == pluginDocModal) pluginDocModal.style.display = "none"; // Close new plugin doc modal by clicking outside
    };
    function openTab(evt, tabName) {
        document.querySelectorAll(".tab-content").forEach(tab => tab.style.display = "none");
        document.querySelectorAll(".tab-button").forEach(btn => btn.classList.remove("active"));
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.classList.add("active");
    }

    updateBotControlButtons();
</script>
</body>
</html>